第十章文檔

“”“”“”“”

在大多數工程師對編寫、使用和維護代碼的抱怨中，一個常見的問題是缺乏高質量的文檔。這個方法的副作用是什麼？我在第三步之後出錯了。”“這個縮寫詞是什麼意思？”“這份文檔是最新的嗎？”每個軟件工程師在他們的職業生涯中都對文檔的質量、數量或完全缺失提出過抱怨，谷歌的軟件工程師也不例外。

技術撰稿人和項目經理可以提供幫助，但軟件工程師總是需要自己編寫大部分的文檔。因此，工程師需要適當的工具和激勵來有效地做到這一點。讓他們更便捷地寫出高質量的文檔的關鍵是引入隨組織擴展並與現有工作流程相結合的流程和工具。

總體而言，年代末的工程文檔狀況與年代末的軟件測試狀態相似。每個人都認識到需要做出更多的努力來改善它，但還沒有組織上認識到它的關鍵好處。這種情況正在改變，儘管很緩慢。在谷歌，我們最成功的努力是將文檔像代碼一樣對待，並將其納入傳統的工程工作流程，使工程師更便捷地編寫和維護文檔。

什麼是合格的文檔？

“”’’

當我們提到“文檔”時，我們談論的是工程師爲完成工作需要編寫的每一個補充文本：不僅是獨立文檔，還有代碼註釋。事實上，谷歌的工程師所寫的大部分文檔都是以代碼註釋的形式出現的）。我們將在本章進一步討論各種類型的工程文檔。

爲什麼需要文檔？

高質量的文檔對一個工程組織有巨大的好處。代碼和變得更容易理解，減少了錯誤。當項目團隊的設計目標和團隊目標明確時，他們會更加專注。當步驟被清楚地列出時，手動流程更容易被遵循。如果流程有明確的文檔記錄，那麼將新成員加入團隊或代碼庫所需的工作量要小得多。

’’’’

’

但是，由於文檔的好處都必然是延後的，它們通常不會給作者帶來直接的好處。與測試不同，測試（正如我們將看到的）很快就能給程序員帶來好處，而文檔編寫通常需要更多的前期工作，直到後來纔會給作者帶來明確的好處。但是，就像對測試的投入一樣，對文檔的投入會隨着時間的推移而得到回報。畢竟，你可能只寫了一次文檔，但之後會被閱讀數百次，甚至數千次；其最初的成本會在所有未來的讀者中攤銷。文檔不僅可以隨着時間的推移而擴展，而且對於組織的其他部分也是至關重要的。它有助於回答這樣的問題：

爲什麼做出這些設計決策？爲什麼我們要以這種方式實現這段代碼？如果你兩年後再看自己的代碼，我爲什麼要以這種方式實現這些代碼？

“”’’

’’’’’’

如果文檔能傳達這麼多的好處，爲什麼工程師們普遍認爲它很糟糕？正如我們所提到的，其中一個原因是，這些好處並不直接，尤其是對作者而言。但還有其他幾個原因：

工程師們通常認爲寫作是一種獨立於編程的技能。我們將試圖說明，事實並非如此，即使是這樣，它也不一定是與軟件工程不同的技能。有些工程師覺得他們不是有寫作能力的人。但是，你不需要精通英語，就能寫出可行的文檔。你只需要跳出自己視角，從聽衆的角度看問題。由於有限的工具支持或集成到開發人員的工作流程中，編寫文檔往往更加困難。文檔被看作是一個額外的負擔需要維護的其他東西而不是能使他們現有的代碼維護更容易的東西。

>>>好的，你將需要維護它並偶爾修改它。>>>>英語仍然是大多數程序員的主要語言，大多數程序員的技術文檔都依賴於對英語的理解。

’

不是每個工程團隊都需要技術撰稿人（即使是需要，也沒有足夠的技術撰稿人）。這意味着，工程師基本上會自己寫大部分的文檔。因此，我們不應該強迫工程師成爲技術撰稿人，而應該考慮如何讓工程師更容易編寫文檔。決定在文檔上投入多少精力是你的組織在某個時候需要做出的決定。

’’’’’’’’

文檔對幾個不同的羣體都有好處。即使對作者來說，文檔也有以下好處：

它有助於制定。編寫文檔是確定是否合理的最可靠方法之一。通常情況下，文檔的編寫本身會導致工程師重新評估設計決策，否則這些決策將會被質疑。如果你不能解釋它，也不能定義它，那麼你可能設計得不夠好。它提供了維護路線圖和歷史記錄。無論如何，應該避免代碼中的技巧，但是當你盯着兩年前編寫的代碼，試圖找出錯誤的地方時，好的註釋會有很大幫助。它使你的代碼看起來更專業，並帶來流量。開發人員通常認爲，一個有良好文檔的是一個設計更好的。情況並非總是如此，但它們往往是高度相關的。雖然這個好處聽起來很表象，但也不盡然：一個產品是否有良好的文檔記錄通常是一個很好的指標，表明一個產品的維護情況如何。它將減少其他用戶提出的問題。隨着時間的推移，這可能是編寫文檔的人最大的收穫。如果你必須向別人解釋不止一次，通常記錄這個過程是有意義的。

’’’“”

儘管這些好處對文檔的作者來說是巨大的，但文檔的大部分好處自然會累積到讀者身上。谷歌的《風格指南》指出了爲讀者優化的格言。這句格言不僅適用於代碼，也適用於代碼周圍的註釋，或者附加到的文檔集。和測試一樣，你爲編寫好的文檔所付出的努力將在其生命週期內多次獲得收益。隨着時間的推移，文檔是非常重要的，隨着組織規模的擴大，對於特別重要的代碼，文檔將獲得巨大的好處。

把文檔當做代碼

用單一的、主要的編程語言編寫的軟件工程師仍然經常使用不同的語言來解決特定的問題。工程師可以編寫腳本或來運行命令行任務，或者他們可以用編寫他們的大部分後端代碼，但是在中編寫一些中間件代碼，等等。每種語言都是工具箱中的一種工具。

’

文檔應該沒有什麼不同：它是一種工具，用不同的語言（通常是英語）編寫，用於完成特定任務。編寫文檔與編寫代碼沒有太大區別。與編程語言一樣，它有規則、特定語法和樣式規範，通常用於實現與代碼中類似的目的：加強一致性、提高清晰度和避免（理解）錯誤。在技術文檔中，語法很重要，不是因爲需要規則，而是爲了使聲音標準化，避免混淆或分散讀者的注意力。出於這個原因，谷歌對其許多語言都要求有一定的註釋風格。

與代碼一樣，文檔也應該有所有者。沒有所有者的文檔會變得陳舊且難以維護。明確的所有權還可以通過現有的開發人員工作流程（跟蹤系統、代碼審查工具等）更輕鬆地處理文檔。當然，不同所有者的文檔仍然可能相互衝突。在這些情況下，指定規範文檔非常重要：確定主要來源，並將其他相關文檔合併到該主要來源中（或棄用副本）。

“”

在谷歌，的普遍使用（見第三章）使這一過程更加容易。有直接的的文件往往成爲權威的標準來源。促進規範化文檔的另一種方法是，通過將它們直接置於源代碼控制之下並與源代碼本身一起，將它們與它們所記錄的代碼直接關聯。

文檔通常與代碼緊密相連，所以應該儘可能地把它當作代碼來對待。也就是說，你的文檔應該：

有需要遵循的內部策略或規則被置於源代碼控制之下有明確的所有權，負責維護文檔對修改進行審查（並與它所記錄的代碼一起改變）。追蹤問題，就像追蹤代碼中的一樣定期評估（在某種程度上測試）。如有可能，對準確度、新鮮度等方面進行衡量（這裏還沒有工具）

“”

工程師們越是把文檔工作當作軟件開發的必要任務之一，他們就越是不反感寫文檔的前期成本，也就越能獲得長期的收益。此外，讓文檔工作變得更容易，可以減少這些前期成本。

案例研究：谷歌維基

當谷歌規模更小、更精簡時，幾乎沒有技術作家。分享信息的最簡單方法是通過我們自己的內部維基（）。起初，這似乎是一個合理的方法；所有工程師共享一個文檔集，可以根據需要進行更新。

但隨着谷歌規模的擴大，維基風格方法的問題變得明顯。因爲沒有真正的文檔所有者，許多文檔變得過時了。因爲沒有建立添加新文檔的流程，重複的文檔和文檔集開始出現了。有一個扁平的命名空間，人們不擅長將任何層次結構應用於文檔集。在某些點上，有到個文檔（取決於你如何計算）用於設置我們的生產計算環境，其中只有少數文檔似乎得到了維護，大多數文檔都是特定於具有特定權限和設定的特指定團隊的。

’’’’“”’’

隨着時間的推移，的另一個問題變得顯而易見：能夠修復文檔的人不是使用它們的人。發現不良文檔的新用戶要麼無法確認文檔是否有誤，要麼無法便捷報告錯誤。他們知道出了問題（因爲文檔不起作用），但他們無法“修復”它。相反，最能修復文檔的人通常不需要在編寫文檔後查閱它們。隨着谷歌的發展，文檔質量變得如此之差，以至於在我們的年度開發者調查中，文檔質量成了谷歌對開發者的第一大抱怨。

改善這種情況的方法是將重要的文檔轉移到與跟蹤代碼變化相同的源代碼控制之下。文檔開始有自己的所有者，在源代碼樹中的規範位置，以及識別和修復的過程；文檔質量開始顯著改善。此外，編寫和維護文檔的方式開始與編寫和維護代碼的方式相同。文檔中的錯誤可以在我們的錯誤跟蹤軟件中報告。對文檔的修改可以通過現有的代碼審查過程來處理。最終，工程師們開始自己修改文檔，或將修改內容發送給技術作家（他們往往是文檔的所有者）。

’

將文檔轉移到源碼控制中，最初遇到了很多爭議。許多工程師相信，取消這個信息自由的堡壘，會導致質量下降，因爲對文檔的要求（要求審查，要求文檔的所有者等）會更高。但事實並非如此。文檔變得更好了。

’’

引入作爲通用的文檔格式化語言也有幫助，因爲它使工程師更容易理解如何編輯文檔，而不需要或方面的專業知識。谷歌最終引入了自己的框架，用於在代碼中嵌入文檔：有了這個框架，文檔得到了進一步的改善，因爲在工程師的開發環境中，文檔與源代碼並列存在。現在，工程師們可以在相同的變更中更新代碼及其相關的文檔（我們仍在努力改進這種做法）。

關鍵的區別在於，維護文檔變成了與維護代碼類似的流程：工程師們提交錯誤，在變更列表中對文檔進行修改，將修改發送給專家審查，等等。利用現有的開發者工作流程，而不是創建新的工作流程，是一個關鍵的好處。

>>>當我們棄用時，我們發現大約的文檔在前幾個月沒有視圖或更新。

瞭解你的受衆

’

工程師在寫文檔時犯的最主要的錯誤之一是隻爲自己寫。這樣做是很自然的，而且爲自己寫也不是沒有價值：畢竟，你可能需要在幾年後看一下這段代碼，並試圖弄清楚你曾經的設計。你也可能與閱讀你的文檔的人具有大致相同的技能。但是，如果你只爲自己寫，你就會做出某些假設，考慮到你的文檔可能會被非常廣泛的讀者閱讀（所有的工程人員、外部開發人員），即使失去幾個讀者也是一個很大的代價。隨着組織的發展，文檔中的錯誤變得更加突出，你的假設往往不適用。

相反，在你開始寫作之前，你應該（正式地或非正式地）確定你的文件需要滿足的受衆。設計文檔可能需要說服決策者。教程可能需要爲完全不熟悉你的代碼庫的人提供非常明確的說明。可能需要爲該的任何用戶（無論是專家還是新手）提供完整準確的參考信息。始終嘗試確定主要受衆併爲該受衆寫作。

“”’

好的文檔不需要潤色或完美。工程師在寫文檔時犯的一個錯誤是假設他們需要成爲更好的作家。按照這個標準，很少有軟件工程師會寫。思考寫作，就像你做測試一樣，或者你作爲一名工程師需要做的任何其他過程。以聽衆期望的聲音和風格向他們寫信。如果你能讀，你就能寫。記住，你的受衆就站在你曾經站過的地方，但沒有你的新領域知識。所以你不需要成爲一個偉大的作家；你只需要找一個像你一樣熟悉這個領域的人。（而且，只要你能從中獲益，你就可以隨着時間的推移改進這份文件。）

受衆類型

’

我們已經指出，你應該按照適合你的受衆的技能水平和領域知識來寫作。但究竟誰是你的受衆？根據以下一個或多個標準，你可能擁有多個受衆：

經驗水平（專家級程序員，或者甚至可能不熟悉語言的初級工程師）。領域知識（團隊成員或組織中只熟悉端點的其他工程師）。目的（可能需要你的來完成特定任務並需要快速找到該信息的最終用戶，或負責你希望沒有其他人需要維護的特別複雜的實現的核心的軟件專家）。

’

在某些情況下，不同的受衆需要不同的寫作風格，但在大多數情況下，技巧是以一種儘可能廣泛地適用於不同受衆羣體的方式進行寫作。通常，你需要同時向專家和新手解釋一個複雜的主題。爲有領域知識的專家寫作方式可能會讓你少走彎路，但你會讓新手感到困惑；反之，向新手詳細解釋一切無疑會讓專家感到厭煩。

’’’“”

顯然，編寫這樣的文檔是一種平衡行爲，沒有什麼靈丹妙藥，但我們發現，它有助於保持文檔的簡短。寫下足夠的描述，向不熟悉該主題的人解釋複雜的主題，但不要失去或惹惱專家。編寫一個簡短的文檔通常需要你編寫一個較長的文檔（將所有信息記錄下來），然後進行編輯，儘可能刪除重複的信息。這聽起來可能很乏味，但請記住，這項費用會分攤到文檔的所有讀者身上。正如布萊斯·帕斯卡（）曾經說過的那樣，“如果我有更多的時間，我會給你寫一封更短的信。”通過保持文檔的簡短和清晰，你將確保它能讓專家和新手都滿意。

’“”“”

另一個重要的受衆區分是基於用戶如何使用文檔：

尋求者，工程師知道他們想要什麼，並且想知道他們所看到的是否符合要求。對於這些聽衆來說，一個關鍵的教學手段是一致性。如果你爲這一羣體寫參考文檔在一個代碼文件內，例如你希望註釋遵循類似的格式，以便受衆可以快速掃描引用並查看是否找到所需內容。瀏覽者，可能不知道他們到底想要什麼。他們可能對如何實施他們正在使用的東西只有一個模糊的概念。這類讀者的關鍵是清晰。提供概述或介紹（例如，在文件的頂部），解釋他們正在查看的代碼的用途。確定文檔何時不適合受衆也很有用。谷歌的很多文件都以聲明開始，如：如果你對谷歌的編譯器不感興趣，你現在可以停止閱讀。

最後，一個重要的受衆區分是客戶（例如，的用戶）和供應方（例如，項目組的成員）。爲一方準備的文件應儘可能與爲另一方準備的文件分開保存。實施細節對於團隊成員的維護非常重要；最終用戶不需要閱讀此類信息。通常，工程師在他們發佈的庫的參考中表示設計決策。這種推理更適合於特定文檔（設計文檔）中，或者充其量是隱藏在接口後面的代碼的實現細節中。

文檔類型

“”

工程師編寫各種不同類型的文檔作爲他們工作的一部分：設計文檔、代碼註釋、操作文檔、項目頁面等等。這些都算作文檔。但重要的是，要了解不同的類型，不要混合類型。一般來說，一個文檔應該有一個單一的用途，並堅持這個職責。就像一個應該做一件事並且做得很好一樣，避免試圖在一個文檔中做幾件事。相反，更邏輯合理地分解這些部分。

軟件工程師經常需要寫的文檔主要有幾種類型：

參考文檔，包括代碼註釋設計文檔教程概念文檔着陸頁

’’

在谷歌的早期，團隊擁有單頁的維基頁面是很常見的，其中有成堆的鏈接（許多鏈接已死鏈或過時），一些關於系統如何工作的概念信息，一個參考等等，這些都散落在一起。這些文檔之所以失敗，是因爲它們沒有一個單一的職責（而且它們也會變得如此之長，以至於沒有人會閱讀它們；一些臭名昭著的頁面滾動了幾十個屏幕）。相反，要確保你的文檔有一個單一的職責，如果向該頁面添加內容沒有意義，可能希望找到或甚至創建另一個用於該用途的文檔。

參考文檔

’’’

參考文檔是工程師最常需要寫的類型；事實上，他們經常每天都需要寫某種形式的參考文檔。所謂參考文檔，我們指的是記錄代碼庫中的代碼使用情況的任何東西。代碼註釋是工程師必須維護的最常見的參考文檔形式。這種註釋可以分爲兩個基本陣營。註釋和實現註釋。記住這兩者之間的受衆差異。註釋不需要討論實現細節或設計決策，也不能假設用戶像作者一樣精通。另一方面，實現註釋可以假定讀者有更多的領域知識，但要小心假設太多：人們離開了項目，有時更安全的做法是有條不紊地說明你爲什麼這樣寫代碼。

“”

大多數參考文檔，即使是作爲獨立於代碼的文檔提供，也是由代碼庫本身的註釋生成的。這是應該的；參考文檔應該儘可能的單一來源。一些語言，如或有特定的註釋框架（、、）旨在簡化參考文檔的生成。其他語言，如，沒有標準的參考文檔實現，但由於將其表面（頭文件或文件）與實現（文件）分開，頭文件通常是記錄的自然場所。

’’’

谷歌採取了這種方法：一個應該有它的參考文件存在頭文件中。其他參考文檔也直接嵌入到、和源代碼中。因爲的瀏覽器（見第章）非常強大，我們發現提供單獨的通用參考文檔沒有什麼好處。用戶在代碼搜索中不僅可以很容易地搜索到代碼，而且通常可以找到該代碼的原始定義作爲最重要的結果。將文檔與代碼的定義放在一起，也使文檔更容易被發現和維護。

“”’’

我們都知道，代碼註釋對於一個良好的文檔化的來說是必不可少的。但是什麼纔是好的註釋呢？在本章的前面，我們確定了參考文檔的兩個主要受衆：尋求者和瀏覽者。尋求者知道他們想要什麼，而瀏覽者不知道。尋求者的關鍵點是一個一致的註釋代碼庫，這樣他們就可以快速掃描並找到他們正在尋找的東西。對於瀏覽者來說，關鍵的勝利是明確識別的用途，通常是在文件頭的頂部。我們將在下面的小節中介紹一些代碼註釋。下面的代碼註釋指南適用於，但在谷歌，其他語言也有類似的規則。

文件註釋

在谷歌，幾乎所有的代碼文件都必須包含一個文件註釋。一些只包含一個實用函數的頭文件等，可能會偏離這個標準。文件註釋應該以下列形式的頭文件開始：

’’

通常，文件註釋應該以你正在閱讀的代碼中所包含的內容的概要開始。它應該確定代碼的主要用例和目標受衆（在前面的例子中，是想要連接字符串的開發者）。在第一段或第二段中無法簡潔描述的任何通常都是未經過深思熟慮的的標誌。在這種情況下，可以考慮將分成獨立的組件。

類註釋

“”“”“”

大多數現代編程語言都是面向對象的。因此，類註釋對於定義代碼庫中使用的對象非常重要。谷歌的所有公共類（和結構）必須包含一個類註釋，描述該類結構、該類的重要方法以及該類的目的。一般來說，類的註釋應該是名詞化的，文件強調其對象方面。也就是說，類包含、、，允許你做，並且有以下方面的內容，等等。

類的註釋一般應該以下列形式的註釋開始：

函數註釋

在谷歌的所有公開函數或類的公共方法也必須包含一個函數註釋，說明函數的功能。函數註釋應該強調其使用的主動性，以一個指示性動詞開始，描述函數的作用和返回的內容。

函數註釋一般應以下列形式的註釋開始：

“”

請注意，用一個聲明性的動詞來開始一個函數註釋，可以在頭文件中引入一致性。尋求者可以快速掃描一個，只讀動詞就可以知道這個函數是否合適。合併、刪除、創建等等。

“”“”’’

一些文檔樣式（和一些文檔生成器）要求在函數註釋中加入各種形式的模板，如，等等，但在谷歌，我們發現它們並不是必須的。在一個鬆散的註釋中呈現這樣的信息通常更清晰，而不是將其分解爲人爲的段落邊界：

請注意後置條件、參數、返回值和異常情況是如何自然地記錄在一起的（在本例中，在一句話中），因爲它們不是相互獨立的。添加明確的樣板部分會使註釋更加冗長和重複，但不會更清晰（也可能不那麼清晰）。

設計文檔

谷歌的大多數團隊在開始任何重大項目之前都需要獲得批准的設計文檔。軟件工程師通常使用團隊批准的特定設計文檔模板編寫擬定設計文件。這些文檔是爲了協作而設計的，所以它們通常在谷歌文檔中共享，谷歌文檔有很好的協作工具。一些團隊要求在特定的團隊會議上討論和辯論此類設計文件，專家可以討論或評論設計的細節。在某些方面，這些設計討論就像是在編寫任何代碼之前的一種代碼審查形式。

由於設計文檔的開發是工程師在部署新系統之前首先進行的過程之一，因此也是確保涵蓋了各種關切。谷歌的典型設計文檔模板要求工程師考慮其設計的各個方面，如安全影響、國際化、存儲要求和隱私問題等等。在大多數情況下，這些設計文檔的這類部分都是由這些領域的專家來審查的。

一個好的設計文檔應該包括設計目標、實施策略，並提出關鍵的設計決策，重點放在它們各自的權衡上。最好的設計文檔建議設計目標，涵蓋替代設計，指出其優缺點。

’

一份好的設計文檔一旦獲得批准，不僅可以作爲歷史記錄，還可以作爲衡量項目是否成功實現其目標的指標。大多數團隊將其設計文檔歸檔在團隊文檔中的適當位置，以便日後進行審查。在產品發佈之前審查設計文檔通常很有用，以確保在編寫設計文檔時所述的目標保持在發佈時所述的目標（如果沒有，則可以相應地調整文檔或產品）。

教程

“”“”“”

每個軟件工程師，當他們加入一個新的團隊時，都希望能儘快進入狀態。有一個指導別人完成新項目設置的教程是非常有價值的；是確保所有團隊成員從正確的角度出發的最佳方式之一。這適用於文件和代碼。大多數項目都應該有一個“文檔，該文檔不做任何假設，並讓工程師去做一些真實的事情。

’’’

通常，如果還沒有教程，編寫教程的最佳時間是你第一次加入團隊時。（這也是在你正在學習的任何現有教程中查找的最佳時機。）使用記事本或其他方式記筆記，並在沒有領域知識或特殊設置限制的情況下，寫下你需要做的所有事情；完成後，你可能會知道在這個過程中犯了哪些錯誤原因然後可以編輯你的步驟，以獲得更精簡的教程。重要的是，寫下你需要做的一切；儘量不要假設任何特定的設置、權限或領域知識。如果你確實需要採用其他設置，請在本教程的開頭明確說明這是一組先決條件。

’

大多數教程要求你按順序執行許多步驟。在這些情況下，請明確爲這些步驟編號。如果本教程的重點是用戶（例如，對於外部開發人員文檔），則對用戶需要執行的每個操作進行編號。不要對系統響應此類用戶操作可能採取的操作進行編號。在執行此操作時，對每個步驟進行明確編號是至關重要的。沒有什麼比步驟中的錯誤更令人惱火的了，例如，你忘記告訴某人對其用戶名進行授權。

<>“”“”

示例：糟糕的教程

從我們的服務器下載軟件包，網址爲<>將腳本複製到主目錄執行腳本系統將與認證系統通信經過身份驗證後，將引導一個名爲“”的新數據庫通過在命令行上執行命令來測試“”類型：創建數據庫；

’’’’

在前面的程序中，步驟和發生在服務器端。不清楚用戶是否需要做什麼，但他們不需要，所以這些副作用可以作爲步驟的一部分提及。同樣，也不清楚步驟和步驟是否不同。它們不是。將所有原子用戶操作組合到單個步驟中，以便用戶知道他們需要在流程的每個步驟中做一些事情。另外，如果你的教程有用戶可見的輸入或輸出，請用單獨的行來表示（通常使用單間距粗體字體）。

<>

“”“”

例子：一個不好的教程會變得更好

從我們的服務器下載軟件包，網址爲<>

將腳本複製到主目錄：

在主目錄中執行腳本：

系統將首先與身份驗證系統通信。經過身份驗證後，將引導一個名爲“”的新數據庫並打開一個輸入。

通過在命令行上執行命令來測試“”：

“”

注意每個步驟都需要指定的用戶操作。相反，如果本教程側重於其他方面（例如，關於“服務器生命週期”的文檔），請從該重點的角度對這些步驟進行編號（服務器的功能）。

概念文檔

有些代碼需要比閱讀參考文檔更深入的解釋或見解。在這些情況下，我們需要概念文檔來提供或系統的概述。概念文檔的一些示例可能是流行的庫概述、描述服務器內數據生命週期的文檔等。在幾乎所有情況下，概念文檔都是爲了補充而不是取代參考文檔集。這通常會導致某些信息的重複，但目的是：提高清晰度。在這些情況下，概念文檔不必涵蓋所有邊緣情況（儘管參考文檔應嚴格涵蓋這些情況）。在這種情況下，爲了清晰起見，犧牲一些準確性是可以接受的。概念文件的要點是傳達瞭解。

“”’’“”

“概念”文檔是最難編寫的文檔形式。因此，它們通常是軟件工程師工具箱中最被忽視的文檔類型。工程師在編寫概念文檔時面臨的一個問題是，它通常無法直接嵌入到源代碼中，因爲沒有一個規範的位置來放置它。一些具有相對廣泛的表面積，在這種情況下，文件註釋可能是對進行“概念性”解釋的合適位置。但是，通常與其他和或模塊一起工作。記錄這種複雜行爲的唯一合理之處是通過一個單獨的概念文檔。如果註釋是文檔的單元測試，那麼概念文檔就是集成測試。

’

即使的範圍適當，提供一個單獨的概念文檔通常也是有意義的。例如，的庫涵蓋了的熟練用戶應該理解的各種概念。在這些情況下，無論是內部還是外部，我們都提供了一個格式概念文檔。

’

概念文檔需要對廣大受衆有用：包括專家和新手。此外，它還需要強調清晰性，因此通常需要犧牲完整性（最好留作參考）和（有時）嚴格的準確性。這並不是說概念性文檔應該故意不準確；這只是意味着它應該關注常見用法，並將罕見用法或副作用留給參考文檔。

着陸頁

“”’“”

大多數工程師都是一個團隊的成員，而大多數團隊在其公司內部網的某個地方都有一個團隊頁面。通常情況下，這些網站有點混亂：一個典型的着陸頁面可能包含一些有趣的鏈接，有時是幾個標題爲先閱讀此文！的文件，以及一些既爲團隊又爲客戶的信息。這些的文檔一開始很有用，但很快就變成了災難；因爲它們的維護變得非常麻煩，最終會變得非常陳舊，只有勇敢的人或絕望的人才會去修復它們。

幸運的是，這些文檔看起來很嚇人，但實際上很容易修復：確保着陸頁清楚地標識其用途，然後只包含指向其他頁面的鏈接以獲取更多信息。如果着陸頁面上的某件事不僅僅是做一名交通警察，那它就沒有做好自己的工作。如果你有單獨的設置文檔，請從着陸頁作爲單獨的文檔鏈接到該文檔。如果你在着陸頁面上有太多鏈接（你的頁面不應該滾動多個屏幕），考慮按分類法將頁面分成不同部分。

“”’“”

大多數配置不好的着陸頁有兩個不同的用途：它們是產品或用戶的“入門”頁面，或者是團隊的主頁。不要讓頁面同時爲兩個主體服務這將變得混亂。創建一個獨立的“團隊頁面”，作爲主着陸頁面之外的內部頁面。團隊內部需要知道的東西往往與你的的客戶需要知道的東西完全不同。

文檔評審

“”

在谷歌，所有的代碼都需要評審，我們的代碼評審是被充分理解和接受的。一般來說，文檔也需要評審（儘管這不太被普遍接受）。如果你想測試你的文檔是否有效，你一般應該讓別人來評審。

一份技術文檔得益於三種不同類型的評審，每一種都關注不同的方面：

技術評審，以保證準確性。這種審查通常是由主題專家完成的，通常是你的團隊的另一個成員。通常，這也是代碼審查本身的一部分。受衆評審，以確保清晰度。這通常是對該領域不熟悉的人。這可能是新加入你的團隊的人或你的的客戶。寫作評審，以保證一致性。這通常是一個技術撰稿人或志願者。

’

當然，其中一些界限有時是模糊的，但如果你的文檔引人矚目或最終可能會在外部發布，你可能希望確保它收到更多類型的評審。我們對這本書採用了類似的評審程序。任何文檔都傾向於從上述評審中受益，即使其中一些評審是臨時性的。也就是說，即使讓一個審查員評審你的文本也比沒有人評審要好。

’

重要的是，如果文檔與工程工作流程聯繫在一起，它往往會隨着時間的推移而改進。現在，谷歌的大多數文檔都隱式地經過受衆審查，因爲在某個時候，他們的讀者會使用這些文檔，並希望在它們不起作用時（通過或其他形式的反饋）讓你知道。

案例研究：開發者指南庫

如前所述，大多數（幾乎所有）工程文件都包含在一個共享的維基中，這其中存在一些問題：重要的文檔沒有所有者、重複的文檔、過時信息，以及難以歸檔的錯誤或文件問題。但是，這個問題在一些文檔中並沒有出現：谷歌風格指南是由一組精選的高級工程師（風格仲裁者）管理的。該文檔被保持良好的狀態，因爲有人關心它。他們隱式地擁有該文檔。該文檔也是規範的：只有一個風格指南。

“”

如前所述，直接位於源代碼中的文檔是促進規範文檔建立的一種方法；如果文檔與源代碼放在一起，它通常應該是最適用的（希望如此）。在谷歌，每個通常都有一個單獨的目錄，這些文檔就在這裏（寫爲標記文件，在我們的代碼搜索瀏覽器中可讀）。將文檔與源代碼放在一起不僅建立了事實上的所有權，而且使文檔看起來更完全是代碼的“一部分”。

“”“”“”

然而，有些文檔集在源代碼中不能非常合理地存在。例如，的“開發者指南”，在源代碼中沒有明確的位置。沒有主目錄，人們會在那裏尋找這些信息。在這種情況下（以及其他跨邊界的情況），在他們自己的倉庫中創建獨立文檔集變得非常有用。其中許多文檔將關聯的現有文檔挑選到一個公共集合中，具有公共導航和外觀。這些文檔被稱爲“開發人員指南”，與代碼庫中的代碼一樣，在一個特定的文檔庫中受源代碼控制，該庫是按主題而不是組織的。通常情況下，技術撰稿人管理這些開發者指南，因爲他們更善於解釋跨邊界的主題。

“”

隨着時間的推移，這些開發者指南成爲經典。編寫重疊或補充文檔的用戶在規範文檔集建立後，開始願意將他們的文檔添加到規範文檔集中，然後廢除他們的重複文檔。最終，風格指南成爲一個更大的開發者指南的一部分。隨着文檔集變得更全面、更權威，其質量也得到了提高。工程師們開始記錄錯誤，因爲他們知道有人在維護這些文檔。由於這些文檔被鎖定在源碼控制之下，並有適當的所有者，工程師們也開始直接向技術作者發送變更列表。

“”

引入（見第章）後，大多數文件實際上可以更容易地建立自己在任何特定主題上的規範性。例如，我們的《開發指南》就建立在上。有了更好的內部搜索、，以及將多個文檔整合到一個共同的文檔集，隨着時間的推移，這樣的規範文檔集變得更加權威和強大。

寫文檔祕訣

“”

注意：以下部分更像是一篇關於技術寫作最佳實踐的論文（和個人觀點），而不是谷歌是如何做到的。對於軟件工程師來說，可以考慮讓他們完全掌握，儘管理解這些概念可能會讓你更容易寫出技術信息。

誰，什麼，何時，何地，爲什麼

“”’“”’

’“”“”’’

大多數技術文檔回答的是如何的問題。它是如何工作的？我如何對這個進行編程？我如何設置這個服務器？因此，軟件工程師有一種傾向，就是在任何給定的文件中直接跳到如何，而忽略了與之相關的其他問題：誰、什麼、什麼時候、什麼地方和爲什麼。誠然，這些問題通常都不如如何重要設計文件是個例外，因爲與之相當的方面往往是爲什麼但如果沒有適當的技術文檔框架，文檔最終會變得混亂。試着在任何文檔的前兩段解決其他問題：

之前討論的是：這就是受衆。但有時你也需要在文件中明確地叫出並解決受衆的問題。例如。本文檔適用於祕密嚮導項目的新工程師。是確定本文檔用途的內容：“本文檔是一個旨在在測試環境中啓動服務器的教程。”有時，只需編寫幫助你正確構建文檔的內容即可。如果開始添加不適用於的信息，則可能需要將該信息移動到單獨的文檔中。是何時確定本文件的創建、審查或更新時間。源代碼中的文檔隱式記錄了該日期，其他一些發佈方案也會自動記錄該日期。但是，如果沒有，請確保在文檔本身上註明文檔的編寫日期（或最後一次修訂日期）。通常也是隱含的，但要決定該文檔應該放在哪裏。通常情況下，偏好應該在某種版本控制之下，最好是與它所記錄的源代碼一起。但其他格式也適用於不同的目的。在，我們經常使用以方便協作，特別是在設計問題上。然而，在某些時候，任何共享的文件都不再是一種討論，而更像是一種穩定的歷史記錄。在這一點上，把它移到一個更永久的地方，有明確的所有權、版本控制和責任。設定文件的目的。總結一下你希望別人在閱讀後能從文件中得到什麼。一個好的經驗法則是在文件的引言中確立爲什麼。當你寫總結的時候，驗證你是否達到了你最初的期望（並進行相應的修改）。

開頭、中間和結尾

’

所有的文檔事實上，文檔的所有部分都有一個開始、中間和結束。雖然這聽起來很愚蠢，但大多數文檔通常至少應該有這三個部分。只有一個部分的文檔只有一句話要說，很少文檔只有一句話要說。不要害怕在文檔中添加條款；它們將流程分解爲邏輯部分，併爲讀者提供文檔內容的路線圖。

“”

即使是最簡單的文檔通常也有不止一句話要說。我們受歡迎的每週提示傳統上是非常簡短的，集中在一個小建議上。然而，即使在這裏，有一些章節也是有幫助的。傳統上，第一部分表示問題，中間部分是推薦的解決方案，結論總結了要點。如果該文檔只有一個部分，一些讀者無疑會難以找出重要的要點。

大多數工程師厭惡冗餘，這是有道理的。但在文檔中，冗餘通常是有用的。隱藏在文字牆內的一個要點可能很難記住或梳理。另一方面，前面將該點放置在更突出的位置可能會丟失後面提供的背景。通常，解決方法是在介紹性段落中介紹和總結要點，然後使用本節的其餘部分以更詳細的方式闡述你的案例。在這種情況下，冗餘有助於讀者理解所述內容的重要性。

良好文檔的衡量標準

“”

好的文檔通常有三個方面：完整性、準確性和清晰性。你很少在同一文檔中得到這三點；例如，當你試圖使文檔更加“完整”時，清晰度可能開始受到影響。如果你試圖記錄一個的每一個可能的用例，你最終可能會得到一個難以理解的混亂。對於編程語言來說，在所有情況下完全準確（以及記錄所有可能的副作用）也會影響清晰度。對於其他文檔，試圖弄清楚一個複雜的主題可能會微妙地影響文檔的準確性；你可能會決定忽略概念文檔中一些罕見的副作用，例如，因爲本文檔的目的是讓某人熟悉的使用，而不是提供所有預期行爲的教條式概述。

“”’

在每種情況下，“良好的文檔”都被定義爲有效的文檔。因此，你很少希望文檔執行多個任務。對於每個文檔（以及每種文檔類型），確定其重點並適當調整寫作。寫概念文檔？你可能不需要涵蓋的每個部分。寫參考文檔？你可能希望這是完整的，但可能必須犧牲一些清晰度。寫着陸頁？專注於組織，並儘量減少討論。所有這些都是爲了提高質量，誠然，這是很難準確衡量的。

’

如何快速提高文檔的質量？關注受衆的需求。通常，少就是多。例如，工程師經常犯的一個錯誤是將設計決策或實現細節添加到文檔中。就像你應該在一個設計良好的中理想地將接口與實現分離一樣，你應該避免在文檔中討論設計決策。用戶不需要知道這些信息。相反，將這些決策放在專門的文檔中（通常是設計文檔）。

廢棄文檔

“”

就像舊代碼可能導致問題一樣，舊文檔也可能導致問題。隨着時間的推移，文檔會變得陳舊、過時或（通常）被廢棄。儘可能避免使用過時的文檔，但當文檔不再具有任何用途時，請將其刪除或將其標識爲已過時（如果可用，請指明獲取新信息的位置）。即使對於無主文檔，有人加上“這不再有效！”的註釋也比什麼都不說，留下一些看似權威但不再有效的東西更有幫助。

“”’

在谷歌，我們經常在文檔中附加“保鮮日期”。此類文檔會記錄文檔最後一次審閱的時間，文檔集中的元數據會在文檔未被觸及時（例如，三個月）發送電子郵件提醒。以下示例中所示的這些更新日期以及作爲跟蹤文檔有助於使文檔集隨着時間的推移更易於維護，這是文檔的主要問題：

<

文檔的新鮮度：更多信息，請看。>

’“”

擁有此類文檔的用戶有保持該新鮮度的動力（如果文檔受源代碼控制，則需要代碼審查）。因此，它是一種低成本的方法，可以確保文檔不時被查看。在谷歌，我們發現在這種新鮮感中包括文檔的所有者文檔中署名爲“”的日期也增加了採用。

何時需要技術撰稿人？

’’

當谷歌年輕和成長時，軟件工程中沒有足夠的技術撰稿人。現在仍然如此。）那些被認爲是重要的項目往往會得到一個技術撰稿人，不管這個團隊是否真的需要。我們的想法是，技術撰稿人可以減輕團隊編寫和維護文檔的一些負擔，（理論上）讓重要的項目取得更快的發展。這被證明是一個錯誤的假設。

’’’’’

我們瞭解到，大多數工程團隊可以爲他們自己（他們的團隊）完美地編寫文檔；只有當他們爲另一個受衆編寫文檔時，他們才傾向於需要幫助，因爲爲另一個受衆編寫文檔很困難。團隊內部關於文檔的反饋迴路更直接，領域知識和假設更清晰，感知的需求也更明顯。當然，技術撰稿人通常可以在語法和組織方面做得更好，但支持一個團隊並不是對有限的專業資源的最佳利用；它沒有規模化。它引入了一個不正當的激勵措施：成爲一個重要的項目，你的軟件工程師就不需要寫文檔了。不鼓勵工程師寫文檔，結果是與你想做的事相反。結果證明，阻止工程師編寫文檔與想要做的恰恰相反。

’’’

因爲他們是有限的資源，技術撰稿人通常應該關注軟件工程師作爲其正常職責的一部分需要完成的任務。通常，這涉及到編寫跨邊界的文檔。項目可能清楚地知道項目需要什麼文檔，但它可能不太清楚項目需要什麼。技術撰稿人更能以不熟悉該領域的人的身份出現。事實上，這是他們的關鍵角色之一：挑戰團隊對項目效用的假設。這就是爲什麼許多（如果不是大多數的話）軟件工程技術撰稿人傾向於關注這種特定類型的文檔的原因之一。

總結

在過去的十年中，谷歌在解決文檔質量方面取得了長足的進步，但坦率地說，谷歌的文檔還不是一等公民。相比之下，工程師們已經逐漸接受了測試對於任何代碼修改都是必要的，無論更改多麼小。同樣，測試工具是健壯的、多樣的，並在不同的點上插入工程工作流程中。文檔還達不到在相同的層次上紮根的。

’’

公平地說，解決文檔問題的必要性不一定和測試一樣。測試可以是原子化的（單元測試），可以遵循規定的形式和功能。在大多數情況下，文檔都做不到。測試可以自動化，而文檔自動化的方案通常是缺乏的。文檔必然是主觀的；文檔的質量不是由作者來衡量的，而是由讀者來衡量的，而且通常是異步的。儘管如此，人們認識到文檔的重要性，圍繞文檔開發的過程也在不斷改進。在筆者看來，谷歌公司的文檔質量比大多數軟件工程公司的要好。

爲了改變工程文檔的質量，工程師和整個工程組織需要接受他們既是問題又是解決方案。他們需要意識到，製作高質量的文檔是他們工作的一部分，從長遠來看，這可以節省他們的時間和精力，而不是在當前文檔狀態下束手無策。對於任何一段生命週期超過幾個月的代碼，記錄該代碼的額外週期不僅有助於其他人，也有助於維護該代碼。

內容提要

隨着時間和規模的增長，文檔是非常重要的。文檔的變化應該利用現有的開發人員的工作流程。讓文檔集中在一個職責（用途）上。爲你的受衆而不是你自己而寫。